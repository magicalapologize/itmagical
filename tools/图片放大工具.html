<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片放大工具 - AI智能无损放大图片 | IT魔法师工具箱</title>
    <meta name="description" content="基于waifu2x人工智能深度卷积神经网络技术，实现图片无损放大，支持多种放大倍率，适用于动漫、照片、插画等多种图像类型。">
    <meta name="keywords" content="图片放大,无损放大,AI放大,waifu2x,图片增强,高清图片,图片处理,超分辨率">
    <meta name="author" content="IT魔法师工具箱">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="图片放大工具 - AI智能无损放大图片">
    <meta property="og:description" content="基于waifu2x人工智能深度卷积神经网络技术，实现图片无损放大，支持多种放大倍率，适用于动漫、照片、插画等多种图像类型。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://itmagical.com/tools/图片放大工具.html">
    <link rel="canonical" href="https://itmagical.com/tools/图片放大工具.html">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/fontawesome-all.min.css">
    <script src="../assets/js/jquery.min.js"></script>
    <style>
        .image-upscaler-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            margin-bottom: 30px;
            background: #f9f9f9;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .upload-area.dragover {
            background: #e9f7fe;
            border-color: #007bff;
        }
        .upload-icon {
            font-size: 48px;
            color: #007bff;
            margin-bottom: 15px;
        }
        .file-input {
            display: none;
        }
        .settings-panel {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        .setting-item {
            margin-bottom: 15px;
        }
        .setting-item label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        .setting-item select, .setting-item input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
        }
        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .action-button {
            padding: 12px 24px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        .action-button:hover {
            background: #0056b3;
            transform: translateY(-2px);
        }
        .action-button.secondary {
            background: #6c757d;
        }
        .action-button.secondary:hover {
            background: #545b62;
        }
        .action-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }
        .preview-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 30px;
        }
        .preview-box {
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .preview-header {
            background: #f8f9fa;
            padding: 12px 16px;
            border-bottom: 1px solid #ddd;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .preview-content {
            padding: 16px;
            text-align: center;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #fff;
        }
        .preview-image {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
        }
        .progress-container {
            margin: 20px 0;
            background: #f1f1f1;
            border-radius: 8px;
            height: 20px;
            overflow: hidden;
            display: none;
        }
        .progress-bar {
            height: 100%;
            width: 0;
            background: linear-gradient(90deg, #007bff, #00c6ff);
            transition: width 0.3s ease;
        }
        .image-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 14px;
        }
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        .info-item {
            display: flex;
            flex-direction: column;
        }
        .info-label {
            font-weight: bold;
            margin-bottom: 5px;
        }
        .batch-container {
            margin-top: 30px;
            display: none;
        }
        .batch-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin-top: 15px;
        }
        .batch-item {
            padding: 12px 16px;
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .batch-item:last-child {
            border-bottom: none;
        }
        .batch-status {
            font-size: 14px;
            padding: 4px 8px;
            border-radius: 4px;
            background: #f1f1f1;
        }
        .batch-status.pending {
            background: #ffeeba;
            color: #856404;
        }
        .batch-status.processing {
            background: #b8daff;
            color: #004085;
        }
        .batch-status.completed {
            background: #c3e6cb;
            color: #155724;
        }
        .batch-status.failed {
            background: #f5c6cb;
            color: #721c24;
        }
        .guide-section {
            background: #f8f9fa;
            padding: 30px;
            margin: 40px 0;
            border-radius: 8px;
        }
        .guide-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .guide-item {
            background: white;
            padding: 20px;
            border-radius: 6px;
            border-left: 4px solid #007bff;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .feature-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
        .feature-icon {
            font-size: 48px;
            color: #007bff;
            margin-bottom: 15px;
        }
        .comparison-container {
            margin: 40px 0;
        }
        .comparison-slider {
            position: relative;
            width: 100%;
            height: 400px;
            border: 1px solid #ddd;
            border-radius: 8px;
            overflow: hidden;
        }
        .comparison-before, .comparison-after {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
        }
        .comparison-after {
            width: 50%;
            border-right: 2px solid white;
        }
        .comparison-handle {
            position: absolute;
            top: 0;
            left: 50%;
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            cursor: ew-resize;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #007bff;
            font-size: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
            z-index: 10;
        }
        .comparison-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }
        .faq-item {
            background: white;
            margin-bottom: 15px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .faq-question {
            padding: 20px;
            background: #f8f9fa;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        .faq-answer.active {
            padding: 20px;
            max-height: 200px;
        }
        @media (max-width: 768px) {
            .preview-container {
                grid-template-columns: 1fr;
            }
            .action-buttons {
                justify-content: center;
            }
        }
    </style>
</head>
<body class="is-preload">
    <!-- 导航栏容器 -->
    <div id="navbar-container"></div>

    <!-- 主要内容 -->
    <div id="main">
        <div class="inner">
            <!-- 工具标题 -->
            <header class="major">
                <h1>图片放大工具</h1>
                <p>基于waifu2x人工智能深度卷积神经网络技术，实现图片无损放大</p>
            </header>

            <!-- 工具功能实现 -->
            <section class="image-upscaler-container">
                <!-- 上传区域 -->
                <div class="upload-area" id="uploadArea" onclick="document.getElementById('fileInput').click()">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3>点击或拖拽上传图片</h3>
                    <p>支持JPG、PNG、WEBP等格式，单张图片大小不超过10MB</p>
                    <input type="file" id="fileInput" class="file-input" accept="image/*" onchange="handleFileSelect(event)">
                </div>

                <!-- 设置面板 -->
                <div class="settings-panel">
                    <h3><i class="fas fa-sliders-h"></i> 放大设置</h3>
                    <div class="settings-grid">
                        <div class="setting-item">
                            <label for="scaleRatio">放大倍率</label>
                            <select id="scaleRatio">
                                <option value="2">2x (两倍)</option>
                                <option value="4">4x (四倍)</option>
                                <option value="8">8x (八倍)</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="noiseReduction">降噪等级</label>
                            <select id="noiseReduction">
                                <option value="0">无降噪</option>
                                <option value="1" selected>低降噪</option>
                                <option value="2">中降噪</option>
                                <option value="3">高降噪</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="imageType">图像类型</label>
                            <select id="imageType">
                                <option value="auto">自动检测</option>
                                <option value="anime">动漫/插画</option>
                                <option value="photo">照片/真实图像</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="outputFormat">输出格式</label>
                            <select id="outputFormat">
                                <option value="png">PNG (无损)</option>
                                <option value="jpg">JPG (高质量)</option>
                                <option value="webp">WEBP (推荐)</option>
                            </select>
                        </div>
                    </div>

                    <!-- 操作按钮 -->
                    <div class="action-buttons">
                        <button id="upscaleBtn" class="action-button" onclick="startUpscale()" disabled>
                            <i class="fas fa-magic"></i> 开始放大
                        </button>
                        <button id="downloadBtn" class="action-button secondary" onclick="downloadImage()" disabled>
                            <i class="fas fa-download"></i> 下载结果
                        </button>
                        <button id="batchModeBtn" class="action-button secondary" onclick="toggleBatchMode()">
                            <i class="fas fa-layer-group"></i> 批量处理
                        </button>
                        <button id="resetBtn" class="action-button secondary" onclick="resetAll()">
                            <i class="fas fa-redo"></i> 重置
                        </button>
                    </div>
                </div>

                <!-- 进度条 -->
                <div id="progressContainer" class="progress-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>

                <!-- 预览区域 -->
                <div id="previewContainer" class="preview-container" style="display: none;">
                    <!-- 原图预览 -->
                    <div class="preview-box">
                        <div class="preview-header">
                            <span>原始图片</span>
                            <span id="originalSize">-</span>
                        </div>
                        <div class="preview-content">
                            <img id="originalImage" class="preview-image" src="" alt="原始图片">
                        </div>
                    </div>

                    <!-- 放大后预览 -->
                    <div class="preview-box">
                        <div class="preview-header">
                            <span>放大结果</span>
                            <span id="upscaledSize">-</span>
                        </div>
                        <div class="preview-content">
                            <img id="upscaledImage" class="preview-image" src="" alt="放大结果">
                        </div>
                    </div>
                </div>

                <!-- 图片信息 -->
                <div id="imageInfo" class="image-info" style="display: none;">
                    <h4>图片信息</h4>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">原始尺寸</span>
                            <span id="originalDimensions">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">放大后尺寸</span>
                            <span id="upscaledDimensions">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">文件大小</span>
                            <span id="fileSize">-</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">处理时间</span>
                            <span id="processTime">-</span>
                        </div>
                    </div>
                </div>

                <!-- 批量处理 -->
                <div id="batchContainer" class="batch-container">
                    <h3><i class="fas fa-layer-group"></i> 批量处理</h3>
                    <p>一次上传多张图片进行批量放大处理，处理完成后可一键下载所有结果。</p>
                    
                    <div class="upload-area" onclick="document.getElementById('batchFiles').click()">
                        <div class="upload-icon">
                            <i class="fas fa-images"></i>
                        </div>
                        <h3>点击或拖拽上传多张图片</h3>
                        <p>最多支持10张图片同时处理，总大小不超过50MB</p>
                        <input type="file" id="batchFiles" class="file-input" accept="image/*" multiple onchange="handleBatchSelect(event)">
                    </div>
                    
                    <div class="action-buttons">
                        <button id="startBatchBtn" class="action-button" onclick="startBatchProcess()" disabled>
                            <i class="fas fa-play"></i> 开始批量处理
                        </button>
                        <button id="downloadAllBtn" class="action-button secondary" onclick="downloadAllResults()" disabled>
                            <i class="fas fa-download"></i> 下载所有结果
                        </button>
                    </div>
                    
                    <div id="batchList" class="batch-list"></div>
                </div>
            </section>

            <!-- 使用指南 -->
            <section class="guide-section">
                <h2><i class="fas fa-book"></i> 使用指南</h2>
                <div class="guide-grid">
                    <div class="guide-item">
                        <h3>1. 上传图片</h3>
                        <p>点击上传区域或拖拽图片到上传区域，支持JPG、PNG、WEBP等常见图片格式。</p>
                    </div>
                    <div class="guide-item">
                        <h3>2. 调整参数</h3>
                        <p>选择放大倍率、降噪等级、图像类型和输出格式，根据需求调整参数获得最佳效果。</p>
                    </div>
                    <div class="guide-item">
                        <h3>3. 开始处理</h3>
                        <p>点击"开始放大"按钮，系统将使用AI技术对图片进行无损放大处理。</p>
                    </div>
                    <div class="guide-item">
                        <h3>4. 下载结果</h3>
                        <p>处理完成后，可以预览放大效果，满意后点击"下载结果"保存到本地。</p>
                    </div>
                </div>
            </section>

            <!-- 工具详细介绍 -->
            <section>
                <h2>工具详细介绍</h2>
                <p>我们的图片放大工具采用了先进的waifu2x人工智能深度卷积神经网络技术，能够智能识别图像内容，在放大过程中保留细节，减少模糊和锯齿，实现真正的"无损放大"。</p>
                
                <p>与传统的图片放大方法不同，我们的AI技术不仅仅是简单地增加像素，而是通过深度学习算法"理解"图像内容，预测和生成缺失的细节，使放大后的图片保持清晰度和质量。</p>
                
                <p>该工具特别适合处理动漫、插画、照片等各类图像，无论是为了打印、展示还是其他用途，都能提供高质量的放大结果。</p>
                
                <!-- 效果对比 -->
                <div class="comparison-container">
                    <h3>效果对比</h3>
                    <p>拖动滑块查看放大前后的效果对比</p>
                    
                    <div class="comparison-slider" id="comparisonSlider">
                        <div class="comparison-before" style="background-image: url('../images/pic01.jpg');"></div>
                        <div class="comparison-after" style="background-image: url('../images/pic02.jpg');"></div>
                        <div class="comparison-handle" id="comparisonHandle">
                            <i class="fas fa-arrows-alt-h"></i>
                        </div>
                    </div>
                    
                    <div class="comparison-labels">
                        <span>原始图片</span>
                        <span>放大后效果</span>
                    </div>
                </div>
            </section>

            <!-- 推广语 -->
            <section class="guide-section">
                <h2>为什么选择我们的图片放大工具？</h2>
                <p style="font-size: 18px; text-align: center; margin-bottom: 30px;">告别模糊不清的图片，让每一张照片都清晰如初</p>
                
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-brain"></i></div>
                        <h3>AI智能技术</h3>
                        <p>采用waifu2x深度卷积神经网络，智能识别图像内容，生成高质量细节</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-tachometer-alt"></i></div>
                        <h3>高效处理</h3>
                        <p>优化的算法实现，处理速度快，支持批量处理多张图片</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-lock"></i></div>
                        <h3>隐私保护</h3>
                        <p>所有处理在本地完成，图片不会上传到服务器，保护您的隐私</p>
                    </div>
                </div>
            </section>

            <!-- 工具优势 -->
            <section>
                <h2>工具优势与核心功能</h2>
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-expand"></i></div>
                        <h3>多倍率放大</h3>
                        <p>支持2x、4x、8x多种放大倍率，满足不同场景需求</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-sliders-h"></i></div>
                        <h3>降噪处理</h3>
                        <p>多级降噪选项，有效去除图像噪点，提升画质</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-image"></i></div>
                        <h3>多种图像支持</h3>
                        <p>针对动漫、照片等不同类型图像优化，效果更佳</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-file-export"></i></div>
                        <h3>多格式输出</h3>
                        <p>支持PNG、JPG、WEBP等多种输出格式</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-layer-group"></i></div>
                        <h3>批量处理</h3>
                        <p>一次处理多张图片，提高工作效率</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-mobile-alt"></i></div>
                        <h3>多平台兼容</h3>
                        <p>支持电脑、平板、手机等多种设备使用</p>
                    </div>
                </div>

                <h3>应用场景</h3>
                <ul style="font-size: 16px; line-height: 2;">
                    <li><strong>动漫爱好者</strong> - 放大低分辨率动漫图片，获得高清壁纸</li>
                    <li><strong>摄影师</strong> - 提升老照片或低像素照片的清晰度</li>
                    <li><strong>设计师</strong> - 放大素材图片，用于高分辨率设计项目</li>
                    <li><strong>电商卖家</strong> - 优化产品图片，提升展示效果</li>
                    <li><strong>社交媒体用户</strong> - 改善分享图片的质量和清晰度</li>
                    <li><strong>打印需求</strong> - 将小尺寸图片放大用于海报、画册等打印物料</li>
                </ul>
            </section>

            <!-- 常见问题 -->
            <section>
                <h2>常见问题解答</h2>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        <span>什么是waifu2x技术？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>waifu2x是一种基于深度卷积神经网络的图像超分辨率技术，最初为动漫图像优化，现已扩展到各类图像处理。它通过AI学习图像特征，在放大过程中重建细节，而非简单插值，从而实现高质量的图像放大。</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        <span>支持哪些图片格式？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>我们的工具支持大多数常见图片格式，包括JPG、PNG、WEBP、BMP、GIF(静态)等。输出格式可选择PNG(无损)、JPG(高质量)或WEBP(推荐，兼顾质量和文件大小)。</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        <span>图片大小和数量有限制吗？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>单张图片处理模式下，支持最大10MB的图片；批量处理模式下，支持最多10张图片同时处理，总大小不超过50MB。处理超大图片可能需要较长时间，建议将大图片分割后处理。</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        <span>如何选择最佳参数？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>对于动漫/插画类图片，建议选择"动漫/插画"图像类型，降噪等级1-2；对于照片，建议选择"照片/真实图像"类型，降噪等级0-1。放大倍率根据需求选择，一般2x已能满足大多数需求，过高倍率可能导致处理时间延长。</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question" onclick="toggleFaq(this)">
                        <span>处理后的图片会上传到服务器吗？</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>不会。我们的工具采用纯前端处理技术，所有图片处理都在您的浏览器本地完成，不会上传到任何服务器，保证您的图片隐私安全。这也意味着处理速度取决于您的设备性能。</p>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <!-- 页脚容器 -->
    <div id="footer-container"></div>

    <!-- 版权信息 -->
    <div style="text-align: center; padding: 20px; background: #f8f9fa; margin-top: 40px;">
        <p>&copy; 2025 基于waifu2x人工智能深度卷积神经网络技术的图片无损放大工具</p>
    </div>

    <script src="../assets/js/browser.min.js"></script>
    <script src="../assets/js/breakpoints.min.js"></script>
    <script src="../assets/js/util.js"></script>
    <script src="../assets/js/main.js"></script>
    
    <script>
        // 全局变量
        let originalImage = null;
        let upscaledImage = null;
        let processingStartTime = 0;
        let batchQueue = [];
        let batchResults = [];
        let isBatchMode = false;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            setupDragAndDrop();
            setupComparisonSlider();
        });
        
        // 设置拖拽上传
        function setupDragAndDrop() {
            const uploadAreas = document.querySelectorAll('.upload-area');
            
            uploadAreas.forEach(area => {
                area.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                area.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });
                
                area.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        if (this.id === 'uploadArea') {
                            // 单文件处理
                            document.getElementById('fileInput').files = files;
                            handleFileSelect({target: {files: [files[0]]}});
                        } else {
                            // 批量处理
                            document.getElementById('batchFiles').files = files;
                            handleBatchSelect({target: {files: files}});
                        }
                    }
                });
            });
        }
        
        // 设置对比滑块
        function setupComparisonSlider() {
            const slider = document.getElementById('comparisonSlider');
            const handle = document.getElementById('comparisonHandle');
            const after = slider.querySelector('.comparison-after');
            
            let isDragging = false;
            
            // 鼠标/触摸事件
            handle.addEventListener('mousedown', startDrag);
            handle.addEventListener('touchstart', startDrag);
            
            document.addEventListener('mousemove', drag);
            document.addEventListener('touchmove', drag);
            
            document.addEventListener('mouseup', endDrag);
            document.addEventListener('touchend', endDrag);
            
            function startDrag(e) {
                e.preventDefault();
                isDragging = true;
            }
            
            function drag(e) {
                if (!isDragging) return;
                
                let clientX;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                } else {
                    clientX = e.clientX;
                }
                
                const rect = slider.getBoundingClientRect();
                const position = Math.max(0, Math.min(1, (clientX - rect.left) / rect.width));
                
                after.style.width = position * 100 + '%';
                handle.style.left = position * 100 + '%';
            }
            
            function endDrag() {
                isDragging = false;
            }
            
            // 点击滑块区域也能移动
            slider.addEventListener('click', function(e) {
                const rect = slider.getBoundingClientRect();
                const position = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                
                after.style.width = position * 100 + '%';
                handle.style.left = position * 100 + '%';
            });
        }
        
        // 处理文件选择
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            // 检查文件类型
            if (!file.type.match('image.*')) {
                alert('请选择图片文件！');
                return;
            }
            
            // 检查文件大小
            if (file.size > 10 * 1024 * 1024) { // 10MB
                alert('图片大小不能超过10MB！');
                return;
            }
            
            // 读取文件
            const reader = new FileReader();
            reader.onload = function(e) {
                // 创建图片对象
                const img = new Image();
                img.onload = function() {
                    // 保存原始图片
                    originalImage = img;
                    
                    // 显示原始图片
                    document.getElementById('originalImage').src = e.target.result;
                    document.getElementById('originalSize').textContent = formatFileSize(file.size);
                    document.getElementById('originalDimensions').textContent = `${img.width} × ${img.height} px`;
                    document.getElementById('fileSize').textContent = formatFileSize(file.size);
                    
                    // 显示预览区域和图片信息
                    document.getElementById('previewContainer').style.display = 'grid';
                    document.getElementById('imageInfo').style.display = 'block';
                    
                    // 启用放大按钮
                    document.getElementById('upscaleBtn').disabled = false;
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }
        
        // 处理批量文件选择
        function handleBatchSelect(event) {
            const files = event.target.files;
            if (!files || files.length === 0) return;
            
            // 检查文件数量
            if (files.length > 10) {
                alert('一次最多处理10张图片！');
                return;
            }
            
            // 检查总大小
            let totalSize = 0;
            for (let i = 0; i < files.length; i++) {
                totalSize += files[i].size;
            }
            
            if (totalSize > 50 * 1024 * 1024) { // 50MB
                alert('总文件大小不能超过50MB！');
                return;
            }
            
            // 清空队列
            batchQueue = [];
            batchResults = [];
            document.getElementById('batchList').innerHTML = '';
            
            // 添加到队列
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                
                // 检查文件类型
                if (!file.type.match('image.*')) continue;
                
                batchQueue.push({
                    file: file,
                    status: 'pending' // pending, processing, completed, failed
                });
                
                // 添加到列表
                const item = document.createElement('div');
                item.className = 'batch-item';
                item.innerHTML = `
                    <div>
                        <strong>${file.name}</strong>
                        <div>${formatFileSize(file.size)}</div>
                    </div>
                    <span class="batch-status pending">等待处理</span>
                `;
                document.getElementById('batchList').appendChild(item);
            }
            
            // 启用批量处理按钮
            document.getElementById('startBatchBtn').disabled = batchQueue.length === 0;
        }
        
        // 开始放大
        function startUpscale() {
            if (!originalImage) return;
            
            // 获取参数
            const scaleRatio = parseInt(document.getElementById('scaleRatio').value);
            const noiseReduction = parseInt(document.getElementById('noiseReduction').value);
            const imageType = document.getElementById('imageType').value;
            
            // 显示进度条
            document.getElementById('progressContainer').style.display = 'block';
            updateProgress(10, '准备处理...');
            
            // 禁用按钮
            document.getElementById('upscaleBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
            
            // 记录开始时间
            processingStartTime = performance.now();
            
            // 模拟处理过程（实际项目中应替换为真实的waifu2x处理）
            simulateUpscale(originalImage, scaleRatio, noiseReduction, imageType);
        }
        
        // 模拟放大处理（实际项目中应替换为真实的waifu2x处理）
        function simulateUpscale(image, scale, noise, type) {
            // 创建一个新的canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // 设置放大后的尺寸
            canvas.width = image.width * scale;
            canvas.height = image.height * scale;
            
            // 更新进度
            updateProgress(30, '正在处理图像...');
            
            // 模拟处理延迟
            setTimeout(() => {
                // 简单放大（实际项目中应替换为waifu2x算法）
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
                
                updateProgress(70, '优化图像质量...');
                
                // 再次延迟模拟处理
                setTimeout(() => {
                    // 获取处理后的图像
                    const dataURL = canvas.toDataURL('image/' + document.getElementById('outputFormat').value);
                    
                    // 创建新图像对象
                    const upscaledImg = new Image();
                    upscaledImg.onload = function() {
                        // 保存放大后的图片
                        upscaledImage = upscaledImg;
                        
                        // 显示放大后的图片
                        document.getElementById('upscaledImage').src = dataURL;
                        document.getElementById('upscaledDimensions').textContent = `${canvas.width} × ${canvas.height} px`;
                        
                        // 计算文件大小（近似值）
                        const byteSize = Math.round(dataURL.length * 0.75);
                        document.getElementById('upscaledSize').textContent = formatFileSize(byteSize);
                        
                        // 计算处理时间
                        const processingTime = Math.round((performance.now() - processingStartTime) / 1000);
                        document.getElementById('processTime').textContent = `${processingTime} 秒`;
                        
                        // 更新进度
                        updateProgress(100, '处理完成！');
                        
                        // 启用下载按钮
                        document.getElementById('downloadBtn').disabled = false;
                        document.getElementById('upscaleBtn').disabled = false;
                    };
                    upscaledImg.src = dataURL;
                }, 1000);
            }, 1000);
        }
        
        // 更新进度条
        function updateProgress(percent, text) {
            document.getElementById('progressBar').style.width = percent + '%';
            // 如果需要显示进度文本，可以添加一个进度文本元素
        }
        
        // 下载放大后的图片
        function downloadImage() {
            if (!upscaledImage) return;
            
            const format = document.getElementById('outputFormat').value;
            const link = document.createElement('a');
            link.href = document.getElementById('upscaledImage').src;
            link.download = `upscaled_image.${format}`;
            link.click();
        }
        
        // 切换批量模式
        function toggleBatchMode() {
            isBatchMode = !isBatchMode;
            
            if (isBatchMode) {
                document.getElementById('batchContainer').style.display = 'block';
                document.getElementById('batchModeBtn').innerHTML = '<i class="fas fa-user"></i> 单张处理';
            } else {
                document.getElementById('batchContainer').style.display = 'none';
                document.getElementById('batchModeBtn').innerHTML = '<i class="fas fa-layer-group"></i> 批量处理';
            }
        }
        
        // 开始批量处理
        function startBatchProcess() {
            if (batchQueue.length === 0) return;
            
            // 禁用按钮
            document.getElementById('startBatchBtn').disabled = true;
            document.getElementById('downloadAllBtn').disabled = true;
            
            // 获取参数
            const scaleRatio = parseInt(document.getElementById('scaleRatio').value);
            const noiseReduction = parseInt(document.getElementById('noiseReduction').value);
            const imageType = document.getElementById('imageType').value;
            const outputFormat = document.getElementById('outputFormat').value;
            
            // 处理队列
            processBatchQueue(0, scaleRatio, noiseReduction, imageType, outputFormat);
        }
        
        // 处理批量队列
        function processBatchQueue(index, scale, noise, type, format) {
            if (index >= batchQueue.length) {
                // 所有图片处理完成
                document.getElementById('downloadAllBtn').disabled = false;
                document.getElementById('startBatchBtn').disabled = false;
                return;
            }
            
            const item = batchQueue[index];
            const statusElement = document.querySelectorAll('.batch-status')[index];
            
            // 更新状态
            item.status = 'processing';
            statusElement.className = 'batch-status processing';
            statusElement.textContent = '处理中...';
            
            // 读取文件
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = new Image();
                img.onload = function() {
                    // 模拟处理（实际项目中应替换为真实的waifu2x处理）
                    setTimeout(() => {
                        // 创建canvas
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        canvas.width = img.width * scale;
                        canvas.height = img.height * scale;
                        
                        // 简单放大
                        ctx.imageSmoothingEnabled = true;
                        ctx.imageSmoothingQuality = 'high';
                        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                        
                        // 获取结果
                        const dataURL = canvas.toDataURL('image/' + format);
                        
                        // 保存结果
                        batchResults.push({
                            name: item.file.name.replace(/\.[^\.]+$/, '') + `_upscaled.${format}`,
                            dataURL: dataURL
                        });
                        
                        // 更新状态
                        item.status = 'completed';
                        statusElement.className = 'batch-status completed';
                        statusElement.textContent = '已完成';
                        
                        // 处理下一张
                        processBatchQueue(index + 1, scale, noise, type, format);
                    }, 2000);
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(item.file);
        }
        
        // 下载所有结果
        function downloadAllResults() {
            if (batchResults.length === 0) return;
            
            // 如果只有一个结果，直接下载
            if (batchResults.length === 1) {
                const link = document.createElement('a');
                link.href = batchResults[0].dataURL;
                link.download = batchResults[0].name;
                link.click();
                return;
            }
            
            // 多个结果，创建zip文件（需要引入JSZip库，此处仅为示例）
            alert('批量下载功能需要引入JSZip库。在实际项目中，您可以将所有处理后的图片打包为一个zip文件下载。');
            
            // 模拟下载每个文件
            for (let i = 0; i < batchResults.length; i++) {
                const link = document.createElement('a');
                link.href = batchResults[i].dataURL;
                link.download = batchResults[i].name;
                setTimeout(() => {
                    link.click();
                }, i * 500);
            }
        }
        
        // 重置所有
        function resetAll() {
            // 重置图片
            originalImage = null;
            upscaledImage = null;
            document.getElementById('originalImage').src = '';
            document.getElementById('upscaledImage').src = '';
            
            // 重置信息
            document.getElementById('originalSize').textContent = '-';
            document.getElementById('upscaledSize').textContent = '-';
            document.getElementById('originalDimensions').textContent = '-';
            document.getElementById('upscaledDimensions').textContent = '-';
            document.getElementById('fileSize').textContent = '-';
            document.getElementById('processTime').textContent = '-';
            
            // 隐藏预览和信息
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('imageInfo').style.display = 'none';
            document.getElementById('progressContainer').style.display = 'none';
            
            // 重置文件输入
            document.getElementById('fileInput').value = '';
            
            // 禁用按钮
            document.getElementById('upscaleBtn').disabled = true;
            document.getElementById('downloadBtn').disabled = true;
            
            // 重置批量处理
            if (isBatchMode) {
                batchQueue = [];
                batchResults = [];
                document.getElementById('batchList').innerHTML = '';
                document.getElementById('batchFiles').value = '';
                document.getElementById('startBatchBtn').disabled = true;
                document.getElementById('downloadAllBtn').disabled = true;
            }
            
            // 重置进度条
            updateProgress(0);
        }
        
        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // FAQ切换
        function toggleFaq(element) {
            const answer = element.nextElementSibling;
            answer.classList.toggle('active');
            
            const icon = element.querySelector('i');
            if (answer.classList.contains('active')) {
                icon.style.transform = 'rotate(180deg)';
            } else {
                icon.style.transform = 'rotate(0deg)';
            }
        }
        
        // 加载导航栏和页脚组件
        $(document).ready(function() {
            $('#navbar-container').load('../components/navbar.html');
            $('#footer-container').load('../components/footer.html');
        });
    </script>
</body>
</html>