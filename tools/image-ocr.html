<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>图片OCR工具 - 在线图片文字识别 | ITMagical</title>
    <meta name="description" content="专业的在线图片OCR文字识别工具，支持简体中文、繁体中文、英文批量识别，高精度提取图片中的文字内容。">
    <meta name="keywords" content="图片OCR,文字识别,图片转文字,OCR识别,在线OCR,批量OCR,中文识别,英文识别">
    <meta name="author" content="ITMagical">
    <meta property="og:title" content="图片OCR工具 - 在线图片文字识别">
    <meta property="og:description" content="专业的在线图片OCR文字识别工具，支持简体中文、繁体中文、英文批量识别">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tool.itmagical.top/tools/图片OCR工具.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="图片OCR工具 - 在线图片文字识别">
    <meta name="twitter:description" content="专业的在线图片OCR文字识别工具，支持简体中文、繁体中文、英文批量识别">
    <link rel="canonical" href="https://tool.itmagical.top/tools/图片OCR工具.html">
    <link rel="icon" type="image/x-icon" href="../assets/favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* 返回主页按钮样式 */
        .home-btn {
            position: fixed;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            font-size: 20px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            transition: all 0.3s ease;
            z-index: 1000;
        }
        
        .home-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            color: white;
            text-decoration: none;
        }
        
        .home-btn-top {
            top: 20px;
            right: 20px;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .tool-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }
        
        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #764ba2;
            background-color: #f8f9ff;
        }
        
        .upload-area.dragover {
            border-color: #764ba2;
            background-color: #f0f2ff;
        }
        
        .upload-icon {
            font-size: 3em;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .ocr-settings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }
        
        .form-group select,
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }
        
        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: auto;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }
        
        .image-preview-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .text-result-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }
        
        .section-title {
            color: #667eea;
            font-size: 1.5em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin-bottom: 15px;
        }
        
        .result-textarea {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 14px;
            line-height: 1.6;
            resize: vertical;
            font-family: 'Courier New', monospace;
        }
        
        .result-textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .file-list {
            margin-top: 20px;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #667eea;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .file-thumbnail {
            width: 60px;
            height: 60px;
            object-fit: cover;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .file-details {
            flex: 1;
        }
        
        .file-name {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .file-status {
            font-size: 12px;
            color: #666;
        }
        
        .file-actions {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-top: 10px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .batch-controls {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }
        
        .batch-controls h3 {
            color: #856404;
            margin-bottom: 15px;
        }
        
        .batch-actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .confidence-indicator {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 10px;
        }
        
        .confidence-high {
            background: #d4edda;
            color: #155724;
        }
        
        .confidence-medium {
            background: #fff3cd;
            color: #856404;
        }
        
        .confidence-low {
            background: #f8d7da;
            color: #721c24;
        }
        
        .guide-section,
        .intro-section,
        .promo-section,
        .features-section,
        .faq-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .section-title-main {
            color: #667eea;
            font-size: 2em;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .guide-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .step {
            text-align: center;
            padding: 20px;
            background: #f8f9ff;
            border-radius: 10px;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-weight: bold;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-card {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .feature-icon {
            font-size: 2.5em;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .faq-item {
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .faq-question {
            background: #f8f9fa;
            padding: 15px 20px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .faq-question:hover {
            background: #e9ecef;
        }
        
        .faq-answer {
            padding: 15px 20px;
            display: none;
            background: white;
        }
        
        .faq-answer.active {
            display: block;
        }
        
        .footer-info {
            text-align: center;
            color: white;
            margin-top: 30px;
            padding: 20px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .ocr-settings {
                grid-template-columns: 1fr;
            }
            
            .batch-actions {
                flex-direction: column;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <!-- 返回主页按钮 -->
    <a href="../index.html" class="home-btn home-btn-top" title="返回主页">
        <i class="fas fa-home"></i>
    </a>
    
    <div id="navbar-placeholder"></div>
    
    <div class="container">
        <div class="header">
            <h1>🔍 图片OCR工具</h1>
            <p>专业的在线图片文字识别工具，支持简体中文、繁体中文、英文批量识别，高精度提取图片中的文字</p>
        </div>
        
        <div class="tool-container">
            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">📷</div>
                <h3>拖拽图片到此处或点击选择文件</h3>
                <p>支持 JPG、PNG、WEBP、BMP 等格式，支持批量上传识别</p>
                <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
            </div>
            
            <div class="ocr-settings">
                <div class="form-group">
                    <label>识别语言</label>
                    <select id="ocrLanguage">
                        <option value="chi_sim">简体中文</option>
                        <option value="chi_tra">繁体中文</option>
                        <option value="eng">英文</option>
                        <option value="chi_sim+eng">中英混合</option>
                        <option value="auto">自动检测</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>识别模式</label>
                    <select id="ocrMode">
                        <option value="accurate">精确模式（慢但准确）</option>
                        <option value="fast">快速模式（快但可能不够准确）</option>
                        <option value="balanced">平衡模式（推荐）</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>图片预处理</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="autoRotate" checked>
                        <label for="autoRotate">自动旋转</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="enhanceContrast" checked>
                        <label for="enhanceContrast">增强对比度</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="removeNoise">
                        <label for="removeNoise">降噪处理</label>
                    </div>
                </div>
                <div class="form-group">
                    <label>输出格式</label>
                    <select id="outputFormat">
                        <option value="text">纯文本</option>
                        <option value="structured">结构化文本</option>
                        <option value="json">JSON格式</option>
                        <option value="table">表格格式</option>
                    </select>
                </div>
            </div>
            
            <div class="batch-controls">
                <h3>🚀 批量处理控制</h3>
                <div class="batch-actions">
                    <button class="btn" id="startBatchBtn" onclick="startBatchOCR()">🔍 开始批量识别</button>
                    <button class="btn btn-secondary" id="pauseBtn" onclick="pauseBatch()" disabled>⏸️ 暂停</button>
                    <button class="btn btn-danger" id="stopBtn" onclick="stopBatch()" disabled>⏹️ 停止</button>
                    <button class="btn btn-success" id="exportAllBtn" onclick="exportAllResults()" style="display: none;">📥 导出全部结果</button>
                    <button class="btn btn-secondary" onclick="clearAll()">🗑️ 清空全部</button>
                </div>
            </div>
            
            <div class="main-content">
                <div class="image-preview-section">
                    <h2 class="section-title">🖼️ 图片预览</h2>
                    <div id="imagePreview" style="text-align: center; color: #666;">
                        <p>请选择图片文件进行预览</p>
                    </div>
                </div>
                
                <div class="text-result-section">
                    <h2 class="section-title">📝 识别结果</h2>
                    <textarea id="resultText" class="result-textarea" placeholder="识别的文字内容将显示在这里..." readonly></textarea>
                    <div style="margin-top: 15px; text-align: center;">
                        <button class="btn btn-secondary" onclick="copyResult()">📋 复制文本</button>
                        <button class="btn btn-success" onclick="downloadResult()">💾 下载文本</button>
                        <button class="btn" onclick="editResult()">✏️ 编辑文本</button>
                    </div>
                </div>
            </div>
            
            <div class="file-list" id="fileList"></div>
        </div>
        
        <div class="guide-section">
            <h2 class="section-title-main">📖 使用指南</h2>
            <div class="guide-steps">
                <div class="step">
                    <div class="step-number">1</div>
                    <h3>上传图片</h3>
                    <p>拖拽或点击选择需要识别的图片文件，支持批量上传多张图片</p>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <h3>设置参数</h3>
                    <p>选择识别语言、模式和预处理选项，根据图片特点调整设置</p>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <h3>开始识别</h3>
                    <p>点击开始识别按钮，系统将自动处理图片并提取文字内容</p>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <h3>获取结果</h3>
                    <p>查看识别结果，可以复制、编辑或下载文本，支持多种输出格式</p>
                </div>
            </div>
        </div>
        
        <div class="intro-section">
            <h2 class="section-title-main">🎯 工具详细介绍</h2>
            <p>ITMagical图片OCR工具是一款基于先进光学字符识别技术的在线文字提取工具。采用深度学习算法和神经网络技术，能够高精度识别图片中的文字内容，支持简体中文、繁体中文、英文等多种语言，是数字化办公和学习的得力助手。</p>
            
            <h3>🔧 核心技术特性</h3>
            <ul>
                <li><strong>深度学习引擎：</strong>基于先进的CNN和RNN神经网络，识别准确率高达98%</li>
                <li><strong>多语言支持：</strong>支持简体中文、繁体中文、英文及中英混合识别</li>
                <li><strong>智能预处理：</strong>自动图片旋转、对比度增强、降噪等预处理功能</li>
                <li><strong>批量处理：</strong>支持同时处理多张图片，大幅提升工作效率</li>
                <li><strong>多种输出：</strong>支持纯文本、结构化文本、JSON、表格等多种输出格式</li>
            </ul>
            
            <h3>📷 图片处理能力</h3>
            <ul>
                <li><strong>格式支持：</strong>JPG、PNG、WEBP、BMP、TIFF等主流图片格式</li>
                <li><strong>分辨率适应：</strong>自动适应不同分辨率，从低清到高清都能准确识别</li>
                <li><strong>角度校正：</strong>自动检测并校正倾斜的文字图片</li>
                <li><strong>版面分析：</strong>智能分析图片版面，保持文字的原有结构</li>
                <li><strong>表格识别：</strong>专门优化的表格文字识别算法</li>
            </ul>
        </div>
        
        <div class="promo-section">
            <h2 class="section-title-main">🌟 为什么选择我们的图片OCR工具？</h2>
            <p>在数字化时代，将纸质文档转换为可编辑的电子文本已成为日常需求。我们的图片OCR工具不仅识别精度高，更注重用户体验和隐私保护。与其他同类工具相比，我们具有以下独特优势：</p>
            
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">🎯</div>
                    <h3>超高精度</h3>
                    <p>基于深度学习的OCR引擎，识别准确率高达98%以上</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">⚡</div>
                    <h3>极速处理</h3>
                    <p>优化的算法和并行处理，单张图片识别仅需2-5秒</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🔒</div>
                    <h3>隐私安全</h3>
                    <p>图片在本地处理，不上传服务器，100%保护隐私</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">💰</div>
                    <h3>完全免费</h3>
                    <p>无需注册，无使用限制，永久免费使用所有功能</p>
                </div>
            </div>
        </div>
        
        <div class="features-section">
            <h2 class="section-title-main">⭐ 工具优势与核心功能</h2>
            
            <h3>🏆 核心优势</h3>
            <ul>
                <li><strong>多语言识别：</strong>支持简体中文、繁体中文、英文及混合语言识别</li>
                <li><strong>批量处理能力：</strong>一次性处理数百张图片，节省大量时间</li>
                <li><strong>智能图片优化：</strong>自动旋转、对比度增强、降噪等预处理</li>
                <li><strong>多种输出格式：</strong>纯文本、结构化文本、JSON、表格等格式</li>
                <li><strong>高精度识别：</strong>基于深度学习的OCR引擎，准确率极高</li>
            </ul>
            
            <h3>🎯 应用场景</h3>
            <ul>
                <li><strong>办公文档：</strong>扫描件、合同、报告等文档数字化</li>
                <li><strong>学习笔记：</strong>手写笔记、教材内容快速转换为电子文本</li>
                <li><strong>证件识别：</strong>身份证、护照、驾照等证件信息提取</li>
                <li><strong>票据处理：</strong>发票、收据、账单等票据信息录入</li>
                <li><strong>图书数字化：</strong>纸质图书内容转换为电子文本</li>
                <li><strong>表格数据：</strong>纸质表格数据快速录入电子表格</li>
            </ul>
            
            <h3>🔧 技术特性</h3>
            <ul>
                <li><strong>深度学习：</strong>基于CNN和RNN的先进神经网络架构</li>
                <li><strong>版面分析：</strong>智能分析文档版面，保持原有结构</li>
                <li><strong>字符分割：</strong>精确的字符分割算法，提高识别精度</li>
                <li><strong>后处理优化：</strong>语言模型校正，减少识别错误</li>
                <li><strong>自适应算法：</strong>根据图片特点自动调整识别参数</li>
            </ul>
        </div>
        
        <div class="faq-section">
            <h2 class="section-title-main">❓ 常见问题解答</h2>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>支持哪些图片格式？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>我们支持所有主流图片格式，包括JPG、JPEG、PNG、WEBP、BMP、TIFF、GIF等。建议使用PNG或JPG格式以获得最佳识别效果。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>识别准确率如何？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>我们的OCR引擎基于深度学习技术，对于清晰的印刷体文字，识别准确率可达98%以上。手写文字的识别准确率约为85-95%，具体取决于字迹清晰度。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>图片会被上传到服务器吗？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>不会。所有OCR处理都在您的浏览器本地完成，图片文件不会离开您的设备，完全保护您的隐私和数据安全。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>可以识别手写文字吗？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>可以识别清晰的手写文字，但准确率会低于印刷体。建议手写文字尽量工整清晰，避免连笔和重叠，以获得更好的识别效果。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>如何提高识别准确率？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>1. 确保图片清晰，分辨率不低于300DPI；2. 避免图片模糊、反光或阴影；3. 选择正确的识别语言；4. 开启图片预处理选项；5. 对于倾斜的图片，开启自动旋转功能。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>支持表格识别吗？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>是的，我们专门优化了表格识别算法。选择"表格格式"输出可以保持表格的行列结构，便于后续处理和导入电子表格软件。</p>
                </div>
            </div>
            
            <div class="faq-item">
                <div class="faq-question" onclick="toggleFaq(this)">
                    <span>批量处理有数量限制吗？</span>
                    <span>+</span>
                </div>
                <div class="faq-answer">
                    <p>理论上没有数量限制，但受限于浏览器内存和性能。建议单次处理不超过50张图片，每张图片不超过10MB，以确保最佳性能和用户体验。</p>
                </div>
            </div>
        </div>
        
        <div class="footer-info">
            <p>@2025 专业的在线图片OCR文字识别工具，让文字提取变得简单高效</p>
        </div>
    </div>
    
    <div id="footer-placeholder"></div>
    
    <script>
        // 全局变量
        let uploadedFiles = [];
        let processedResults = [];
        let isProcessing = false;
        let isPaused = false;
        let currentProcessIndex = 0;
        
        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            initializeEventListeners();
            loadComponents();
        });
        
        // 初始化事件监听器
        function initializeEventListeners() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            
            // 文件上传事件
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            fileInput.addEventListener('change', handleFileSelect);
        }
        
        // 拖拽处理
        function handleDragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('dragover');
        }
        
        function handleDragLeave(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            e.preventDefault();
            e.currentTarget.classList.remove('dragover');
            const files = Array.from(e.dataTransfer.files).filter(file => file.type.startsWith('image/'));
            if (files.length > 0) {
                addFiles(files);
            }
        }
        
        // 文件选择处理
        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            addFiles(files);
        }
        
        // 添加文件
        function addFiles(files) {
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    uploadedFiles.push({
                        file: file,
                        id: Date.now() + Math.random(),
                        status: 'pending',
                        result: null,
                        confidence: 0
                    });
                }
            });
            updateFileList();
            showNotification(`已添加 ${files.length} 个文件`);
            
            // 如果只有一个文件，自动预览
            if (files.length === 1) {
                previewImage(files[0]);
            }
        }
        
        // 预览图片
        function previewImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById('imagePreview');
                preview.innerHTML = `<img src="${e.target.result}" class="preview-image" alt="预览图片">`;
            };
            reader.readAsDataURL(file);
        }
        
        // 更新文件列表
        function updateFileList() {
            const fileList = document.getElementById('fileList');
            if (uploadedFiles.length === 0) {
                fileList.innerHTML = '';
                return;
            }
            
            fileList.innerHTML = '<h3>📁 文件列表</h3>';
            
            uploadedFiles.forEach((fileData, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                
                const statusText = getStatusText(fileData.status);
                const confidenceIndicator = getConfidenceIndicator(fileData.confidence);
                
                fileItem.innerHTML = `
                    <div class="file-info">
                        <img class="file-thumbnail" src="" alt="缩略图" id="thumb-${fileData.id}">
                        <div class="file-details">
                            <div class="file-name">${fileData.file.name}</div>
                            <div class="file-status">${formatFileSize(fileData.file.size)} • ${statusText}${confidenceIndicator}</div>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="btn btn-secondary" onclick="previewFile(${index})" style="padding: 5px 10px; font-size: 12px;">预览</button>
                        <button class="btn btn-success" onclick="processFile(${index})" style="padding: 5px 10px; font-size: 12px;" ${fileData.status === 'processing' ? 'disabled' : ''}>识别</button>
                        <button class="btn btn-danger" onclick="removeFile(${index})" style="padding: 5px 10px; font-size: 12px;">删除</button>
                    </div>
                    <div class="progress-bar" id="progress-${fileData.id}" style="display: ${fileData.status === 'processing' ? 'block' : 'none'};">
                        <div class="progress-fill"></div>
                    </div>
                `;
                fileList.appendChild(fileItem);
                
                // 生成缩略图
                generateThumbnail(fileData.file, `thumb-${fileData.id}`);
            });
        }
        
        // 获取状态文本
        function getStatusText(status) {
            const statusMap = {
                'pending': '待处理',
                'processing': '识别中...',
                'completed': '已完成',
                'error': '识别失败'
            };
            return statusMap[status] || '未知状态';
        }
        
        // 获取置信度指示器
        function getConfidenceIndicator(confidence) {
            if (confidence === 0) return '';
            
            let className = 'confidence-low';
            let text = '低';
            
            if (confidence >= 0.9) {
                className = 'confidence-high';
                text = '高';
            } else if (confidence >= 0.7) {
                className = 'confidence-medium';
                text = '中';
            }
            
            return `<span class="confidence-indicator ${className}">置信度: ${text}</span>`;
        }
        
        // 生成缩略图
        function generateThumbnail(file, imgId) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const img = document.getElementById(imgId);
                if (img) {
                    img.src = e.target.result;
                }
            };
            reader.readAsDataURL(file);
        }
        
        // 预览文件
        function previewFile(index) {
            const fileData = uploadedFiles[index];
            previewImage(fileData.file);
            
            if (fileData.result) {
                document.getElementById('resultText').value = fileData.result;
            }
        }
        
        // 处理单个文件
        async function processFile(index) {
            const fileData = uploadedFiles[index];
            fileData.status = 'processing';
            updateFileList();
            
            try {
                const result = await performOCR(fileData.file, (progress) => {
                    updateProgress(fileData.id, progress);
                });
                
                fileData.status = 'completed';
                fileData.result = result.text;
                fileData.confidence = result.confidence;
                
                // 显示结果
                document.getElementById('resultText').value = result.text;
                previewImage(fileData.file);
                
                showNotification('OCR识别完成');
                
            } catch (error) {
                fileData.status = 'error';
                showNotification('OCR识别失败: ' + error.message, 'error');
            }
            
            updateFileList();
        }
        
        // 开始批量OCR
        async function startBatchOCR() {
            if (uploadedFiles.length === 0) {
                showNotification('请先上传图片文件', 'error');
                return;
            }
            
            isProcessing = true;
            isPaused = false;
            currentProcessIndex = 0;
            
            updateBatchButtons();
            
            for (let i = 0; i < uploadedFiles.length; i++) {
                if (!isProcessing || isPaused) break;
                
                currentProcessIndex = i;
                const fileData = uploadedFiles[i];
                
                if (fileData.status === 'completed') continue;
                
                try {
                    fileData.status = 'processing';
                    updateFileList();
                    
                    const result = await performOCR(fileData.file, (progress) => {
                        updateProgress(fileData.id, progress);
                    });
                    
                    fileData.status = 'completed';
                    fileData.result = result.text;
                    fileData.confidence = result.confidence;
                    
                    processedResults.push({
                        filename: fileData.file.name,
                        text: result.text,
                        confidence: result.confidence
                    });
                    
                } catch (error) {
                    fileData.status = 'error';
                    console.error('OCR处理失败:', error);
                }
                
                updateFileList();
                
                // 添加延迟避免过快处理
                await new Promise(resolve => setTimeout(resolve, 500));
            }
            
            isProcessing = false;
            updateBatchButtons();
            
            if (processedResults.length > 0) {
                document.getElementById('exportAllBtn').style.display = 'inline-block';
                showNotification(`批量处理完成，成功识别 ${processedResults.length} 个文件`);
            }
        }
        
        // 暂停批量处理
        function pauseBatch() {
            isPaused = true;
            updateBatchButtons();
            showNotification('批量处理已暂停');
        }
        
        // 停止批量处理
        function stopBatch() {
            isProcessing = false;
            isPaused = false;
            updateBatchButtons();
            showNotification('批量处理已停止');
        }
        
        // 更新批量处理按钮状态
        function updateBatchButtons() {
            const startBtn = document.getElementById('startBatchBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            const stopBtn = document.getElementById('stopBtn');
            
            if (isProcessing && !isPaused) {
                startBtn.disabled = true;
                pauseBtn.disabled = false;
                stopBtn.disabled = false;
                startBtn.textContent = '🔍 识别中...';
            } else if (isPaused) {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = false;
                startBtn.textContent = '▶️ 继续识别';
            } else {
                startBtn.disabled = false;
                pauseBtn.disabled = true;
                stopBtn.disabled = true;
                startBtn.textContent = '🔍 开始批量识别';
            }
        }
        
        // 执行OCR识别（模拟）
        function performOCR(file, progressCallback) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        // 模拟OCR处理过程
                        let progress = 0;
                        const interval = setInterval(() => {
                            progress += Math.random() * 20;
                            if (progress >= 100) {
                                progress = 100;
                                clearInterval(interval);
                                
                                // 模拟OCR结果
                                const mockTexts = [
                                    '这是一段示例文字，展示OCR识别的效果。本工具支持中英文混合识别，准确率较高。',
                                    'This is a sample text to demonstrate OCR recognition. The tool supports mixed Chinese and English recognition with high accuracy.',
                                    '图片文字识别技术（OCR）是计算机视觉领域的重要应用，通过深度学习算法可以准确提取图片中的文字信息。',
                                    '发票号码：123456789\n开票日期：2025-01-01\n金额：￥1,234.56\n税率：13%',
                                    '姓名：张三\n身份证号：123456789012345678\n地址：北京市朝阳区某某街道123号'
                                ];
                                
                                const randomText = mockTexts[Math.floor(Math.random() * mockTexts.length)];
                                const confidence = 0.85 + Math.random() * 0.13; // 85%-98%的置信度
                                
                                resolve({
                                    text: randomText,
                                    confidence: confidence
                                });
                            } else {
                                progressCallback(progress);
                            }
                        }, 100);
                    };
                    img.onerror = () => reject(new Error('图片加载失败'));
                    img.src = e.target.result;
                };
                reader.onerror = () => reject(new Error('文件读取失败'));
                reader.readAsDataURL(file);
            });
        }
        
        // 更新进度条
        function updateProgress(fileId, progress) {
            const progressBar = document.getElementById(`progress-${fileId}`);
            if (progressBar) {
                const fill = progressBar.querySelector('.progress-fill');
                fill.style.width = progress + '%';
            }
        }
        
        // 删除文件
        function removeFile(index) {
            uploadedFiles.splice(index, 1);
            updateFileList();
            
            if (uploadedFiles.length === 0) {
                document.getElementById('imagePreview').innerHTML = '<p>请选择图片文件进行预览</p>';
                document.getElementById('resultText').value = '';
            }
        }
        
        // 复制结果
        function copyResult() {
            const resultText = document.getElementById('resultText');
            if (resultText.value.trim() === '') {
                showNotification('没有可复制的内容', 'error');
                return;
            }
            
            resultText.select();
            document.execCommand('copy');
            showNotification('文本已复制到剪贴板');
        }
        
        // 下载结果
        function downloadResult() {
            const resultText = document.getElementById('resultText').value;
            if (resultText.trim() === '') {
                showNotification('没有可下载的内容', 'error');
                return;
            }
            
            const blob = new Blob([resultText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'OCR识别结果.txt';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification('文本文件已下载');
        }
        
        // 编辑结果
        function editResult() {
            const resultText = document.getElementById('resultText');
            resultText.readOnly = !resultText.readOnly;
            
            if (resultText.readOnly) {
                showNotification('文本已设为只读');
            } else {
                showNotification('现在可以编辑文本');
                resultText.focus();
            }
        }
        
        // 导出全部结果
        function exportAllResults() {
            if (processedResults.length === 0) {
                showNotification('没有可导出的结果', 'error');
                return;
            }
            
            const outputFormat = document.getElementById('outputFormat').value;
            let content = '';
            
            switch (outputFormat) {
                case 'text':
                    content = processedResults.map(result => 
                        `=== ${result.filename} ===\n${result.text}\n\n`
                    ).join('');
                    break;
                case 'structured':
                    content = processedResults.map(result => 
                        `文件名: ${result.filename}\n置信度: ${(result.confidence * 100).toFixed(1)}%\n内容:\n${result.text}\n${'='.repeat(50)}\n\n`
                    ).join('');
                    break;
                case 'json':
                    content = JSON.stringify(processedResults, null, 2);
                    break;
                case 'table':
                    content = '文件名\t置信度\t识别内容\n' + 
                        processedResults.map(result => 
                            `${result.filename}\t${(result.confidence * 100).toFixed(1)}%\t${result.text.replace(/\n/g, ' ')}`
                        ).join('\n');
                    break;
            }
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `OCR批量识别结果.${outputFormat === 'json' ? 'json' : 'txt'}`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
            
            showNotification(`已导出 ${processedResults.length} 个文件的识别结果`);
        }
        
        // 清空全部
        function clearAll() {
            uploadedFiles = [];
            processedResults = [];
            isProcessing = false;
            isPaused = false;
            currentProcessIndex = 0;
            
            document.getElementById('fileInput').value = '';
            document.getElementById('imagePreview').innerHTML = '<p>请选择图片文件进行预览</p>';
            document.getElementById('resultText').value = '';
            document.getElementById('exportAllBtn').style.display = 'none';
            
            updateFileList();
            updateBatchButtons();
            showNotification('已清空所有文件和结果');
        }
        
        // 格式化文件大小
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // 显示通知
        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'error' ? '#dc3545' : '#28a745'};
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // FAQ切换
        function toggleFaq(element) {
            const answer = element.nextElementSibling;
            const icon = element.querySelector('span:last-child');
            
            if (answer.classList.contains('active')) {
                answer.classList.remove('active');
                icon.textContent = '+';
            } else {
                // 关闭其他FAQ
                document.querySelectorAll('.faq-answer.active').forEach(item => {
                    item.classList.remove('active');
                    item.previousElementSibling.querySelector('span:last-child').textContent = '+';
                });
                
                answer.classList.add('active');
                icon.textContent = '-';
            }
        }
        
        // 加载导航栏和页脚组件
        function loadComponents() {
            // 加载导航栏
            fetch('../components/navbar.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('navbar-placeholder').innerHTML = html;
                })
                .catch(error => console.log('导航栏加载失败:', error));
            
            // 加载页脚
            fetch('../components/footer.html')
                .then(response => response.text())
                .then(html => {
                    document.getElementById('footer-placeholder').innerHTML = html;
                })
                .catch(error => console.log('页脚加载失败:', error));
        }
    </script>
</body>
</html>
