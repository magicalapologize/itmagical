<!DOCTYPE HTML>
<html>
<head>
    <title>PDFå·¥å…·é›† - ITé­”æ³•å¸ˆ</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
    <style>
        .pdf-tool {
            background: #fff;
            border-radius: 10px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .tool-tabs {
            display: flex;
            flex-wrap: wrap;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .tab-button {
            padding: 15px 20px;
            background: #c2185b;
            border: 1px solid #ad1457;
            border-radius: 6px 6px 0 0;
            cursor: pointer;
            font-size: 14px;
            color: white;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            margin-right: 2px;
        }
        
        .tab-button:hover {
            background: #ad1457;
            color: white;
        }
        
        .tab-button.active {
            background: #007acc;
            color: white;
            border-bottom-color: #007acc;
            font-weight: bold;
            border-color: #007acc;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .upload-area:hover {
            border-color: #007acc;
            background: #f8f9fa;
        }
        
        .upload-area.dragover {
            border-color: #007acc;
            background: #e3f2fd;
        }
        
        .file-input {
            display: none;
        }
        
        .pdf-controls {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .control-group {
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .control-group label {
            min-width: 120px;
            font-weight: bold;
        }
        
        .input-field {
            flex: 1;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .slider {
            flex: 1;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider::-webkit-slider-thumb {
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #007acc;
            cursor: pointer;
        }
        
        .file-list {
            margin: 20px 0;
        }
        
        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            margin: 10px 0;
            background: #fff;
        }
        
        .file-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .file-icon {
            width: 40px;
            height: 40px;
            background: #dc3545;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            font-weight: bold;
        }
        
        .file-details h4 {
            margin: 0;
            color: #333;
        }
        
        .file-details p {
            margin: 5px 0 0 0;
            color: #666;
            font-size: 14px;
        }
        
        .file-actions {
            display: flex;
            gap: 10px;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #007acc, #0056b3);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .merge-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .option-card {
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .option-card:hover {
            border-color: #007acc;
            background: #f8f9fa;
        }
        
        .option-card.selected {
            border-color: #007acc;
            background: #e3f2fd;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 12px 20px;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            position: relative;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 12px 20px;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            position: relative;
        }
        
        .info-message {
            background: #d1ecf1;
            color: #0c5460;
            padding: 12px 20px;
            border: 1px solid #bee5eb;
            border-radius: 6px;
            margin: 10px 0;
            font-size: 14px;
            position: relative;
        }
        
        .page-range {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 15px 0;
        }
        
        .page-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-align: center;
        }
        
        .watermark-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .watermark-preview {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            background: #f8f9fa;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .button {
            display: inline-block;
            padding: 12px 24px;
            background: #007acc;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 5px;
        }
        
        .button:hover {
            background: #005a9e;
            transform: translateY(-2px);
        }
        
        .button.secondary {
            background: #6c757d;
        }
        
        .button.secondary:hover {
            background: #545b62;
        }
        
        .button.success {
            background: #28a745;
        }
        
        .button.success:hover {
            background: #1e7e34;
        }
        
        .button.danger {
            background: #dc3545;
        }
        
        .button.danger:hover {
            background: #c82333;
        }
        
        .button.small {
            padding: 8px 16px;
            font-size: 14px;
        }
        
        .result-area {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #007acc;
        }
        
        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #dc3545;
        }
        
        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 6px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        
        .info-box {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
            border-left: 4px solid #17a2b8;
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .feature-card {
            padding: 25px;
            border: 1px solid #ddd;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .feature-icon {
            font-size: 48px;
            color: #007acc;
            margin-bottom: 15px;
        }
        
        @media (max-width: 768px) {
            .tool-tabs {
                flex-direction: column;
            }
            
            .tab-button {
                text-align: left;
                border-bottom: 1px solid #eee;
                border-radius: 0;
            }
            
            .control-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .control-group label {
                min-width: auto;
            }
            
            .watermark-options {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="is-preload">
    <!-- Wrapper -->
    <div id="wrapper">
        <!-- Header -->
        <header id="header">
            <h1><a href="index.html">ITé­”æ³•å¸ˆ</a></h1>
            <nav id="nav">
                <ul>
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="æ ¼å¼è½¬æ¢å·¥å…·.html">æ ¼å¼è½¬æ¢</a></li>
                    <li><a href="æ–‡æœ¬å¤„ç†å·¥å…·.html">æ–‡æœ¬å¤„ç†</a></li>
                    <li><a href="å›¾ç‰‡å‹ç¼©å·¥å…·.html">å›¾ç‰‡å‹ç¼©</a></li>
                    <li><a href="éŸ³é¢‘å¤„ç†å·¥å…·.html">éŸ³é¢‘å¤„ç†</a></li>
                    <li><a href="è§†é¢‘å¤„ç†å·¥å…·.html">è§†é¢‘å¤„ç†</a></li>
                    <li class="current"><a href="pdfå·¥å…·é›†.html">PDFå·¥å…·</a></li>
                </ul>
            </nav>
        </header>

        <!-- Main -->
        <div id="main" class="wrapper style1">
            <div class="container">
                <header class="major">
                    <h2>PDFå·¥å…·é›†</h2>
                    <p>ä¸“ä¸šçš„PDFå¤„ç†å·¥å…·ï¼Œè®©æ–‡æ¡£å¤„ç†æ›´åŠ ä¾¿æ·é«˜æ•ˆ</p>
                </header>

                <div class="pdf-tool">
                    <div class="tool-tabs">
                        <button class="tab-button active" onclick="showTab('convert')">æ ¼å¼è½¬æ¢</button>
                        <button class="tab-button" onclick="showTab('merge')">åˆå¹¶PDF</button>
                        <button class="tab-button" onclick="showTab('split')">æ‹†åˆ†PDF</button>
                        <button class="tab-button" onclick="showTab('compress')">å‹ç¼©PDF</button>
                        <button class="tab-button" onclick="showTab('extract')">é¡µé¢æå–</button>
                        <button class="tab-button" onclick="showTab('watermark')">æ·»åŠ æ°´å°</button>
                        <button class="tab-button" onclick="showTab('protect')">å¯†ç ä¿æŠ¤</button>
                        <button class="tab-button" onclick="showTab('unlock')">è§£é™¤ä¿æŠ¤</button>
                    </div>

                    <!-- æ ¼å¼è½¬æ¢ -->
                    <div id="convert" class="tab-content active">
                        <h3>PDFæ ¼å¼è½¬æ¢</h3>
                        <div class="upload-area" onclick="document.getElementById('convertFile').click()">
                            <div class="feature-icon">ğŸ“„</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>æ”¯æŒè½¬æ¢ä¸ºWordã€Excelã€PowerPointã€å›¾ç‰‡ç­‰æ ¼å¼</p>
                            <input type="file" id="convertFile" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>è½¬æ¢æ ¼å¼:</label>
                                <select id="convertFormat" class="input-field">
                                    <option value="docx">Wordæ–‡æ¡£ (.docx)</option>
                                    <option value="xlsx">Excelè¡¨æ ¼ (.xlsx)</option>
                                    <option value="pptx">PowerPoint (.pptx)</option>
                                    <option value="jpg">JPEGå›¾ç‰‡ (.jpg)</option>
                                    <option value="png">PNGå›¾ç‰‡ (.png)</option>
                                    <option value="txt">çº¯æ–‡æœ¬ (.txt)</option>
                                    <option value="html">ç½‘é¡µ (.html)</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label>é¡µé¢èŒƒå›´:</label>
                                <input type="text" id="convertPages" class="input-field" placeholder="ä¾‹å¦‚: 1-5, 8, 10-12 (ç•™ç©ºè½¬æ¢å…¨éƒ¨)">
                            </div>
                            <div class="control-group">
                                <label>å›¾ç‰‡è´¨é‡:</label>
                                <input type="range" id="convertQuality" class="slider" min="50" max="100" value="85">
                                <span id="convertQualityValue">85%</span>
                            </div>
                        </div>
                        
                        <div class="file-list" id="convertFileList"></div>
                        
                        <button class="button" onclick="startConvert()">å¼€å§‹è½¬æ¢</button>
                        <button class="button secondary" onclick="clearFiles('convert')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- åˆå¹¶PDF -->
                    <div id="merge" class="tab-content">
                        <h3>åˆå¹¶PDFæ–‡ä»¶</h3>
                        <div class="upload-area" onclick="document.getElementById('mergeFiles').click()">
                            <div class="feature-icon">ğŸ“š</div>
                            <h4>é€‰æ‹©å¤šä¸ªPDFæ–‡ä»¶</h4>
                            <p>å°†å¤šä¸ªPDFæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶</p>
                            <input type="file" id="mergeFiles" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>åˆå¹¶æ–¹å¼:</label>
                                <select id="mergeMode" class="input-field">
                                    <option value="order">æŒ‰é€‰æ‹©é¡ºåº</option>
                                    <option value="name">æŒ‰æ–‡ä»¶åæ’åº</option>
                                    <option value="size">æŒ‰æ–‡ä»¶å¤§å°æ’åº</option>
                                    <option value="date">æŒ‰ä¿®æ”¹æ—¶é—´æ’åº</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label>è¾“å‡ºæ–‡ä»¶å:</label>
                                <input type="text" id="mergeFileName" class="input-field" placeholder="åˆå¹¶åçš„æ–‡ä»¶å" value="merged_document.pdf">
                            </div>
                        </div>
                        
                        <div class="file-list" id="mergeFileList"></div>
                        
                        <button class="button" onclick="startMerge()">å¼€å§‹åˆå¹¶</button>
                        <button class="button secondary" onclick="clearFiles('merge')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- æ‹†åˆ†PDF -->
                    <div id="split" class="tab-content">
                        <h3>æ‹†åˆ†PDFæ–‡ä»¶</h3>
                        <div class="upload-area" onclick="document.getElementById('splitFile').click()">
                            <div class="feature-icon">âœ‚ï¸</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>å°†PDFæ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªæ–‡ä»¶</p>
                            <input type="file" id="splitFile" class="file-input" accept=".pdf">
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>æ‹†åˆ†æ–¹å¼:</label>
                                <select id="splitMode" class="input-field" onchange="toggleSplitOptions()">
                                    <option value="pages">æŒ‰é¡µæ•°æ‹†åˆ†</option>
                                    <option value="range">æŒ‰é¡µé¢èŒƒå›´</option>
                                    <option value="size">æŒ‰æ–‡ä»¶å¤§å°</option>
                                    <option value="bookmark">æŒ‰ä¹¦ç­¾æ‹†åˆ†</option>
                                </select>
                            </div>
                            <div class="control-group" id="pagesPerFile">
                                <label>æ¯ä¸ªæ–‡ä»¶é¡µæ•°:</label>
                                <input type="number" id="splitPages" class="input-field" value="1" min="1">
                            </div>
                            <div class="control-group" id="pageRanges" style="display:none;">
                                <label>é¡µé¢èŒƒå›´:</label>
                                <input type="text" id="splitRanges" class="input-field" placeholder="ä¾‹å¦‚: 1-3, 5-8, 10-15">
                            </div>
                            <div class="control-group" id="maxSize" style="display:none;">
                                <label>æœ€å¤§æ–‡ä»¶å¤§å°(MB):</label>
                                <input type="number" id="splitSize" class="input-field" value="5" min="1">
                            </div>
                        </div>
                        
                        <div class="file-list" id="splitFileList"></div>
                        
                        <button class="button" onclick="startSplit()">å¼€å§‹æ‹†åˆ†</button>
                        <button class="button secondary" onclick="clearFiles('split')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- å‹ç¼©PDF -->
                    <div id="compress" class="tab-content">
                        <h3>å‹ç¼©PDFæ–‡ä»¶</h3>
                        <div class="upload-area" onclick="document.getElementById('compressFiles').click()">
                            <div class="feature-icon">ğŸ—œï¸</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>å‡å°PDFæ–‡ä»¶å¤§å°ï¼Œä¿æŒè‰¯å¥½çš„é˜…è¯»è´¨é‡</p>
                            <input type="file" id="compressFiles" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>å‹ç¼©çº§åˆ«:</label>
                                <select id="compressLevel" class="input-field">
                                    <option value="low">ä½å‹ç¼© (é«˜è´¨é‡)</option>
                                    <option value="medium" selected>ä¸­ç­‰å‹ç¼© (å¹³è¡¡)</option>
                                    <option value="high">é«˜å‹ç¼© (å°æ–‡ä»¶)</option>
                                    <option value="extreme">æé™å‹ç¼© (æœ€å°æ–‡ä»¶)</option>
                                </select>
                            </div>
                            <div class="control-group">
                                <label>å›¾ç‰‡è´¨é‡:</label>
                                <input type="range" id="compressQuality" class="slider" min="30" max="100" value="75">
                                <span id="compressQualityValue">75%</span>
                            </div>
                            <div class="control-group">
                                <label>å›¾ç‰‡åˆ†è¾¨ç‡:</label>
                                <select id="compressResolution" class="input-field">
                                    <option value="300">300 DPI (æ‰“å°è´¨é‡)</option>
                                    <option value="150" selected>150 DPI (å±å¹•è´¨é‡)</option>
                                    <option value="72">72 DPI (ç½‘é¡µè´¨é‡)</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="file-list" id="compressFileList"></div>
                        
                        <button class="button" onclick="startCompress()">å¼€å§‹å‹ç¼©</button>
                        <button class="button secondary" onclick="clearFiles('compress')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- é¡µé¢æå– -->
                    <div id="extract" class="tab-content">
                        <h3>æå–PDFé¡µé¢</h3>
                        <div class="upload-area" onclick="document.getElementById('extractFile').click()">
                            <div class="feature-icon">ğŸ“‹</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>æå–æŒ‡å®šé¡µé¢åˆ›å»ºæ–°çš„PDFæ–‡ä»¶</p>
                            <input type="file" id="extractFile" class="file-input" accept=".pdf">
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>æå–é¡µé¢:</label>
                                <input type="text" id="extractPages" class="input-field" placeholder="ä¾‹å¦‚: 1, 3-5, 8, 10-12">
                            </div>
                            <div class="control-group">
                                <label>è¾“å‡ºæ–‡ä»¶å:</label>
                                <input type="text" id="extractFileName" class="input-field" placeholder="æå–çš„é¡µé¢" value="extracted_pages.pdf">
                            </div>
                        </div>
                        
                        <div class="file-list" id="extractFileList"></div>
                        
                        <button class="button" onclick="startExtract()">å¼€å§‹æå–</button>
                        <button class="button secondary" onclick="clearFiles('extract')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- æ·»åŠ æ°´å° -->
                    <div id="watermark" class="tab-content">
                        <h3>æ·»åŠ æ°´å°</h3>
                        <div class="upload-area" onclick="document.getElementById('watermarkFiles').click()">
                            <div class="feature-icon">ğŸ·ï¸</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>ä¸ºPDFæ–‡ä»¶æ·»åŠ æ–‡å­—æˆ–å›¾ç‰‡æ°´å°</p>
                            <input type="file" id="watermarkFiles" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="watermark-options">
                            <div>
                                <div class="pdf-controls">
                                    <div class="control-group">
                                        <label>æ°´å°ç±»å‹:</label>
                                        <select id="watermarkType" class="input-field" onchange="toggleWatermarkOptions()">
                                            <option value="text">æ–‡å­—æ°´å°</option>
                                            <option value="image">å›¾ç‰‡æ°´å°</option>
                                        </select>
                                    </div>
                                    <div class="control-group" id="textWatermark">
                                        <label>æ°´å°æ–‡å­—:</label>
                                        <input type="text" id="watermarkText" class="input-field" placeholder="è¾“å…¥æ°´å°æ–‡å­—" value="æœºå¯†æ–‡æ¡£">
                                    </div>
                                    <div class="control-group" id="imageWatermark" style="display:none;">
                                        <label>æ°´å°å›¾ç‰‡:</label>
                                        <input type="file" id="watermarkImage" class="input-field" accept="image/*">
                                    </div>
                                    <div class="control-group">
                                        <label>ä½ç½®:</label>
                                        <select id="watermarkPosition" class="input-field">
                                            <option value="center">å±…ä¸­</option>
                                            <option value="top-left">å·¦ä¸Šè§’</option>
                                            <option value="top-right">å³ä¸Šè§’</option>
                                            <option value="bottom-left">å·¦ä¸‹è§’</option>
                                            <option value="bottom-right">å³ä¸‹è§’</option>
                                        </select>
                                    </div>
                                    <div class="control-group">
                                        <label>é€æ˜åº¦:</label>
                                        <input type="range" id="watermarkOpacity" class="slider" min="10" max="100" value="30">
                                        <span id="watermarkOpacityValue">30%</span>
                                    </div>
                                    <div class="control-group">
                                        <label>å¤§å°:</label>
                                        <input type="range" id="watermarkSize" class="slider" min="10" max="100" value="50">
                                        <span id="watermarkSizeValue">50%</span>
                                    </div>
                                </div>
                            </div>
                            <div class="watermark-preview">
                                <div id="watermarkPreview">æ°´å°é¢„è§ˆåŒºåŸŸ</div>
                            </div>
                        </div>
                        
                        <div class="file-list" id="watermarkFileList"></div>
                        
                        <button class="button" onclick="startWatermark()">æ·»åŠ æ°´å°</button>
                        <button class="button secondary" onclick="clearFiles('watermark')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- å¯†ç ä¿æŠ¤ -->
                    <div id="protect" class="tab-content">
                        <h3>å¯†ç ä¿æŠ¤</h3>
                        <div class="upload-area" onclick="document.getElementById('protectFiles').click()">
                            <div class="feature-icon">ğŸ”’</div>
                            <h4>é€‰æ‹©PDFæ–‡ä»¶</h4>
                            <p>ä¸ºPDFæ–‡ä»¶æ·»åŠ å¯†ç ä¿æŠ¤</p>
                            <input type="file" id="protectFiles" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>ç”¨æˆ·å¯†ç :</label>
                                <input type="password" id="userPassword" class="input-field" placeholder="æ‰“å¼€æ–‡æ¡£æ‰€éœ€å¯†ç ">
                            </div>
                            <div class="control-group">
                                <label>æ‰€æœ‰è€…å¯†ç :</label>
                                <input type="password" id="ownerPassword" class="input-field" placeholder="ä¿®æ”¹æƒé™æ‰€éœ€å¯†ç ">
                            </div>
                            <div class="control-group">
                                <label>æƒé™è®¾ç½®:</label>
                                <div style="display: flex; flex-direction: column; gap: 10px;">
                                    <label><input type="checkbox" id="allowPrint" checked> å…è®¸æ‰“å°</label>
                                    <label><input type="checkbox" id="allowCopy" checked> å…è®¸å¤åˆ¶</label>
                                    <label><input type="checkbox" id="allowModify"> å…è®¸ä¿®æ”¹</label>
                                    <label><input type="checkbox" id="allowAnnotate"> å…è®¸æ³¨é‡Š</label>
                                </div>
                            </div>
                        </div>
                        
                        <div class="file-list" id="protectFileList"></div>
                        
                        <button class="button" onclick="startProtect()">æ·»åŠ ä¿æŠ¤</button>
                        <button class="button secondary" onclick="clearFiles('protect')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>

                    <!-- è§£é™¤ä¿æŠ¤ -->
                    <div id="unlock" class="tab-content">
                        <h3>è§£é™¤å¯†ç ä¿æŠ¤</h3>
                        <div class="upload-area" onclick="document.getElementById('unlockFiles').click()">
                            <div class="feature-icon">ğŸ”“</div>
                            <h4>é€‰æ‹©å—ä¿æŠ¤çš„PDFæ–‡ä»¶</h4>
                            <p>ç§»é™¤PDFæ–‡ä»¶çš„å¯†ç ä¿æŠ¤</p>
                            <input type="file" id="unlockFiles" class="file-input" accept=".pdf" multiple>
                        </div>
                        
                        <div class="pdf-controls">
                            <div class="control-group">
                                <label>æ–‡æ¡£å¯†ç :</label>
                                <input type="password" id="unlockPassword" class="input-field" placeholder="è¾“å…¥æ–‡æ¡£å¯†ç ">
                            </div>
                        </div>
                        
                        <div class="file-list" id="unlockFileList"></div>
                        
                        <button class="button" onclick="startUnlock()">è§£é™¤ä¿æŠ¤</button>
                        <button class="button secondary" onclick="clearFiles('unlock')">æ¸…ç©ºæ–‡ä»¶</button>
                    </div>
                </div>

                <!-- åŠŸèƒ½ç‰¹è‰²å±•ç¤º -->
                <div class="feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon">âš¡</div>
                        <h3>å¿«é€Ÿå¤„ç†</h3>
                        <p>é«˜æ•ˆçš„PDFå¤„ç†ç®—æ³•ï¼Œå¿«é€Ÿå®Œæˆå„ç§æ“ä½œ</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ”’</div>
                        <h3>å®‰å…¨å¯é </h3>
                        <p>æœ¬åœ°å¤„ç†ï¼Œæ–‡ä»¶ä¸ä¸Šä¼ æœåŠ¡å™¨ï¼Œä¿æŠ¤éšç§å®‰å…¨</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">ğŸ“±</div>
                        <h3>å¤šè®¾å¤‡æ”¯æŒ</h3>
                        <p>æ”¯æŒç”µè„‘ã€å¹³æ¿ã€æ‰‹æœºç­‰å„ç§è®¾å¤‡è®¿é—®ä½¿ç”¨</p>
                    </div>
                </div>

                <div class="info-box">
                    <h4>ä½¿ç”¨è¯´æ˜</h4>
                    <ul>
                        <li>æ”¯æŒçš„PDFç‰ˆæœ¬ï¼š1.4 - 1.7</li>
                        <li>å•ä¸ªæ–‡ä»¶å¤§å°é™åˆ¶ï¼š100MB</li>
                        <li>æ‰¹é‡å¤„ç†æ–‡ä»¶æ•°é‡ï¼šæœ€å¤š20ä¸ª</li>
                        <li>æ‰€æœ‰å¤„ç†éƒ½åœ¨æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œç¡®ä¿æ–‡ä»¶å®‰å…¨</li>
                        <li>å»ºè®®ä½¿ç”¨Chromeã€Firefoxã€Safariç­‰ç°ä»£æµè§ˆå™¨</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer id="footer">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <section class="contact">
                            <header>
                                <h3>PDFå·¥å…·é›†ä½¿ç”¨å¸®åŠ©</h3>
                            </header>
                            <p>å¦‚æœæ‚¨åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ä½¿ç”¨è¯´æ˜æˆ–è”ç³»æˆ‘ä»¬è·å–å¸®åŠ©ã€‚</p>
                            <ul class="icons">
                                <li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
                                <li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
                                <li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
                                <li><a href="#" class="icon brands fa-pinterest"><span class="label">Pinterest</span></a></li>
                                <li><a href="#" class="icon brands fa-dribbble"><span class="label">Dribbble</span></a></li>
                                <li><a href="#" class="icon brands fa-linkedin-in"><span class="label">LinkedIn</span></a></li>
                            </ul>
                        </section>
                        <div class="copyright">
                            <ul class="menu">
                                <li>&copy; ITé­”æ³•å¸ˆ. All rights reserved.</li>
                                <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <!-- Scripts -->
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/js/jquery.dropotron.min.js"></script>
    <script src="assets/js/browser.min.js"></script>
    <script src="assets/js/breakpoints.min.js"></script>
    <script src="assets/js/util.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf-lib/1.17.1/pdf-lib.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    
    <script>
        // å…¨å±€å˜é‡
        let currentFiles = {};
        
        // åŠ¨æ€åŠ è½½PDF.jsåº“
        async function loadPDFJS() {
            if (typeof pdfjsLib !== 'undefined') {
                return;
            }
            
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js';
                script.onload = () => {
                    if (typeof pdfjsLib !== 'undefined') {
                        // è®¾ç½®PDF.js worker
                        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
                        resolve();
                    } else {
                        reject(new Error('PDF.jsåŠ è½½å¤±è´¥'));
                    }
                };
                script.onerror = () => reject(new Error('æ— æ³•åŠ è½½PDF.jsåº“'));
                document.head.appendChild(script);
            });
        }
        let processedFiles = [];
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        function showTab(tabName) {
            // éšè—æ‰€æœ‰æ ‡ç­¾é¡µå†…å®¹
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // æ˜¾ç¤ºé€‰ä¸­çš„æ ‡ç­¾é¡µ
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }
        
        // æ–‡ä»¶ä¸Šä¼ å¤„ç†
        function setupFileUpload() {
            const fileInputs = document.querySelectorAll('.file-input');
            const uploadAreas = document.querySelectorAll('.upload-area');
            
            fileInputs.forEach((input, index) => {
                input.addEventListener('change', function(e) {
                    const files = Array.from(e.target.files);
                    const tabName = this.id.replace(/Files?$/, '').replace(/File$/, '');
                    handleFiles(files, tabName);
                });
            });
            
            uploadAreas.forEach(area => {
                area.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });
                
                area.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });
                
                area.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    const files = Array.from(e.dataTransfer.files);
                    const tabName = this.querySelector('.file-input').id.replace(/Files?$/, '').replace(/File$/, '');
                    handleFiles(files, tabName);
                });
            });
        }
        
        // å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶
        function handleFiles(files, tabName) {
            if (!currentFiles[tabName]) {
                currentFiles[tabName] = [];
            }
            
            files.forEach(file => {
                if (file.type === 'application/pdf' || file.name.toLowerCase().endsWith('.pdf')) {
                    currentFiles[tabName].push(file);
                } else {
                    showMessage('åªæ”¯æŒPDFæ–‡ä»¶æ ¼å¼', 'error');
                }
            });
            
            updateFileList(tabName);
        }
        
        // æ›´æ–°æ–‡ä»¶åˆ—è¡¨æ˜¾ç¤º
        function updateFileList(tabName) {
            const fileList = document.getElementById(tabName + 'FileList');
            if (!fileList || !currentFiles[tabName]) return;
            
            fileList.innerHTML = '';
            
            currentFiles[tabName].forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon">PDF</div>
                        <div class="file-details">
                            <h4>${file.name}</h4>
                            <p>${formatFileSize(file.size)} â€¢ ${new Date(file.lastModified).toLocaleDateString()}</p>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="button small danger" onclick="removeFile('${tabName}', ${index})">åˆ é™¤</button>
                    </div>
                `;
                fileList.appendChild(fileItem);
            });
        }
        
        // ç§»é™¤æ–‡ä»¶
        function removeFile(tabName, index) {
            if (currentFiles[tabName]) {
                currentFiles[tabName].splice(index, 1);
                updateFileList(tabName);
            }
        }
        
        // æ¸…ç©ºæ–‡ä»¶
        function clearFiles(tabName) {
            if (currentFiles[tabName]) {
                currentFiles[tabName] = [];
                updateFileList(tabName);
            }
        }
        
        // æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            
            if (type === 'error') {
                messageDiv.className = 'error-message';
            } else if (type === 'success') {
                messageDiv.className = 'success-message';
            } else {
                messageDiv.className = 'info-message';
            }
            
            messageDiv.textContent = message;
            
            const container = document.querySelector('.pdf-tool');
            container.insertBefore(messageDiv, container.firstChild);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°æ¶ˆæ¯ä½ç½®
            messageDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, type === 'info' ? 3000 : 5000);
        }
        
        // æ»‘å—å€¼æ›´æ–°
        function setupSliders() {
            const sliders = document.querySelectorAll('.slider');
            sliders.forEach(slider => {
                const valueSpan = document.getElementById(slider.id + 'Value');
                if (valueSpan) {
                    slider.addEventListener('input', function() {
                        valueSpan.textContent = this.value + '%';
                    });
                }
            });
        }
        
        // æ‹†åˆ†é€‰é¡¹åˆ‡æ¢
        function toggleSplitOptions() {
            const mode = document.getElementById('splitMode').value;
            document.getElementById('pagesPerFile').style.display = mode === 'pages' ? 'flex' : 'none';
            document.getElementById('pageRanges').style.display = mode === 'range' ? 'flex' : 'none';
            document.getElementById('maxSize').style.display = mode === 'size' ? 'flex' : 'none';
        }
        
        // æ°´å°é€‰é¡¹åˆ‡æ¢
        function toggleWatermarkOptions() {
            const type = document.getElementById('watermarkType').value;
            document.getElementById('textWatermark').style.display = type === 'text' ? 'flex' : 'none';
            document.getElementById('imageWatermark').style.display = type === 'image' ? 'flex' : 'none';
        }
        
        // PDFå¤„ç†å‡½æ•°ï¼ˆä½¿ç”¨PDF-libåº“ï¼‰
        async function startConvert() {
            if (!currentFiles.convert || currentFiles.convert.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            const format = document.getElementById('convertFormat').value;
            const file = currentFiles.convert[0];
            
            try {
                showMessage('æ­£åœ¨è½¬æ¢PDFæ–‡ä»¶...', 'info');
                
                if (format === 'txt') {
                    // è½¬æ¢ä¸ºæ–‡æœ¬æ ¼å¼
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                    const pages = pdf.getPages();
                    
                    let textContent = `PDFè½¬æ¢ç»“æœ\næ–‡ä»¶å: ${file.name}\nè½¬æ¢æ ¼å¼: TXT\nè½¬æ¢æ—¶é—´: ${new Date().toLocaleString()}\né¡µæ•°: ${pages.length}\n\n`;
                    
                    // æå–PDFåŸºæœ¬ä¿¡æ¯å’Œç»“æ„
                    for (let i = 0; i < pages.length; i++) {
                        const page = pages[i];
                        const { width, height } = page.getSize();
                        textContent += `--- ç¬¬ ${i + 1} é¡µ ---\n`;
                        textContent += `é¡µé¢å°ºå¯¸: ${Math.round(width)} x ${Math.round(height)}\n`;
                        
                        // å°è¯•è·å–é¡µé¢å†…å®¹ï¼ˆPDF-libæœ‰é™çš„æ–‡æœ¬æå–èƒ½åŠ›ï¼‰
                        try {
                            // è·å–é¡µé¢çš„åŸºæœ¬ä¿¡æ¯
                            const pageDict = page.node;
                            textContent += `é¡µé¢å†…å®¹: PDFé¡µé¢åŒ…å«æ–‡æœ¬ã€å›¾åƒæˆ–å…¶ä»–å…ƒç´ \n`;
                            textContent += `æ³¨æ„: å®Œæ•´çš„æ–‡æœ¬æå–éœ€è¦ä¸“é—¨çš„PDFè§£æåº“\n\n`;
                        } catch (e) {
                            textContent += `é¡µé¢å†…å®¹: æ— æ³•æå–è¯¦ç»†æ–‡æœ¬å†…å®¹\n\n`;
                        }
                    }
                    
                    textContent += `\nè½¬æ¢è¯´æ˜:\n`;
                    textContent += `- æ­¤å·¥å…·æä¾›PDFåŸºæœ¬ä¿¡æ¯æå–\n`;
                    textContent += `- å®Œæ•´çš„æ–‡æœ¬æå–åŠŸèƒ½éœ€è¦æœåŠ¡å™¨ç«¯æ”¯æŒ\n`;
                    textContent += `- å»ºè®®ä½¿ç”¨ä¸“ä¸šPDFé˜…è¯»å™¨è¿›è¡Œæ–‡æœ¬å¤åˆ¶\n`;
                    
                    // åˆ›å»ºä¸‹è½½é“¾æ¥
                    const blob = new Blob([textContent], { type: 'text/plain;charset=utf-8' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = file.name.replace('.pdf', '_info.txt');
                    link.click();
                    URL.revokeObjectURL(url);
                    
                    showMessage('PDFä¿¡æ¯å·²æˆåŠŸæå–ä¸ºTXTæ ¼å¼ï¼', 'success');
                } else if (format === 'images') {
                    // è½¬æ¢ä¸ºå›¾ç‰‡æ ¼å¼ - ä½¿ç”¨PDF.jsæ¸²æŸ“
                    try {
                        // æ£€æŸ¥æ˜¯å¦æ”¯æŒPDF.js
                        if (typeof pdfjsLib === 'undefined') {
                            // åŠ¨æ€åŠ è½½PDF.js
                            await loadPDFJS();
                        }
                        
                        const arrayBuffer = await file.arrayBuffer();
                        const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;
                        const numPages = pdf.numPages;
                        
                        showMessage(`æ­£åœ¨å°†PDFè½¬æ¢ä¸º${numPages}å¼ å›¾ç‰‡...`, 'info');
                        
                        const images = [];
                        
                        // é€é¡µæ¸²æŸ“ä¸ºå›¾ç‰‡
                        for (let pageNum = 1; pageNum <= numPages; pageNum++) {
                            const page = await pdf.getPage(pageNum);
                            const scale = 2.0; // æé«˜åˆ†è¾¨ç‡
                            const viewport = page.getViewport({ scale });
                            
                            const canvas = document.createElement('canvas');
                            const context = canvas.getContext('2d');
                            canvas.height = viewport.height;
                            canvas.width = viewport.width;
                            
                            const renderContext = {
                                canvasContext: context,
                                viewport: viewport
                            };
                            
                            await page.render(renderContext).promise;
                            
                            // è½¬æ¢ä¸ºå›¾ç‰‡æ•°æ®
                            const imageData = canvas.toDataURL('image/png');
                            images.push({
                                data: imageData,
                                filename: `${file.name.replace('.pdf', '')}_page_${pageNum}.png`
                            });
                        }
                        
                        // ä¸‹è½½æ‰€æœ‰å›¾ç‰‡
                        images.forEach((img, index) => {
                            setTimeout(() => {
                                const link = document.createElement('a');
                                link.href = img.data;
                                link.download = img.filename;
                                link.click();
                            }, index * 500); // å»¶è¿Ÿä¸‹è½½é¿å…æµè§ˆå™¨é˜»æ­¢
                        });
                        
                        showMessage(`PDFå·²æˆåŠŸè½¬æ¢ä¸º${numPages}å¼ å›¾ç‰‡ï¼`, 'success');
                        
                    } catch (error) {
                        console.error('PDF.jsæ¸²æŸ“å¤±è´¥:', error);
                        // é™çº§åˆ°åŸºæœ¬ä¿¡æ¯æå–
                        const arrayBuffer = await file.arrayBuffer();
                        const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                        const pages = pdf.getPages();
                        
                        const infoContent = `PDFè½¬å›¾ç‰‡åŠŸèƒ½è¯´æ˜\n\nåŸæ–‡ä»¶: ${file.name}\né¡µæ•°: ${pages.length}\nè½¬æ¢æ—¶é—´: ${new Date().toLocaleString()}\n\nè¯´æ˜:\n- å›¾ç‰‡è½¬æ¢éœ€è¦PDF.jsåº“æ”¯æŒ\n- å½“å‰æµè§ˆå™¨ç¯å¢ƒå¯èƒ½ä¸æ”¯æŒå®Œæ•´çš„PDFæ¸²æŸ“\n- å»ºè®®ä½¿ç”¨ç°ä»£æµè§ˆå™¨æˆ–ä¸“ä¸šPDFå·¥å…·\n\næŠ€æœ¯ä¿¡æ¯:\n- é”™è¯¯: ${error.message}\n- å»ºè®®: æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–å°è¯•è¾ƒå°çš„PDFæ–‡ä»¶`;
                        
                        const blob = new Blob([infoContent], { type: 'text/plain;charset=utf-8' });
                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = file.name.replace('.pdf', '_conversion_info.txt');
                        link.click();
                        URL.revokeObjectURL(url);
                        
                        showMessage('PDFè½¬æ¢é‡åˆ°é—®é¢˜ï¼Œå·²ç”Ÿæˆè¯´æ˜æ–‡ä»¶', 'error');
                    }
                } else {
                    showMessage('æš‚ä¸æ”¯æŒè¯¥æ ¼å¼è½¬æ¢', 'error');
                }
            } catch (error) {
                console.error('è½¬æ¢å¤±è´¥:', error);
                showMessage('è½¬æ¢å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        async function startMerge() {
            if (!currentFiles.merge || currentFiles.merge.length < 2) {
                showMessage('è¯·é€‰æ‹©è‡³å°‘2ä¸ªPDFæ–‡ä»¶è¿›è¡Œåˆå¹¶', 'error');
                return;
            }
            
            try {
                const mergedPdf = await PDFLib.PDFDocument.create();
                
                for (const file of currentFiles.merge) {
                    const arrayBuffer = await file.arrayBuffer();
                    const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                    const pages = await mergedPdf.copyPages(pdf, pdf.getPageIndices());
                    pages.forEach((page) => mergedPdf.addPage(page));
                }
                
                const pdfBytes = await mergedPdf.save();
                const fileName = document.getElementById('mergeFileName').value || 'merged_document.pdf';
                downloadFile(pdfBytes, fileName, 'application/pdf');
                
                showMessage('PDFåˆå¹¶å®Œæˆï¼', 'success');
            } catch (error) {
                showMessage('åˆå¹¶å¤±è´¥ï¼š' + error.message, 'error');
            }
        }
        
        async function startSplit() {
            if (!currentFiles.split || currentFiles.split.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            const file = currentFiles.split[0];
            const mode = document.getElementById('splitMode').value;
            
            try {
                showMessage('æ­£åœ¨æ‹†åˆ†PDFæ–‡ä»¶...', 'info');
                
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                const totalPages = pdf.getPageCount();
                
                if (mode === 'pages') {
                    // æŒ‰é¡µæ•°æ‹†åˆ†
                    const pagesPerFile = parseInt(document.getElementById('pagesPerFileInput').value) || 1;
                    const numFiles = Math.ceil(totalPages / pagesPerFile);
                    
                    for (let i = 0; i < numFiles; i++) {
                        const newPdf = await PDFLib.PDFDocument.create();
                        const startPage = i * pagesPerFile;
                        const endPage = Math.min(startPage + pagesPerFile, totalPages);
                        
                        const pages = await newPdf.copyPages(pdf, Array.from({length: endPage - startPage}, (_, j) => startPage + j));
                        pages.forEach(page => newPdf.addPage(page));
                        
                        const pdfBytes = await newPdf.save();
                        const fileName = `${file.name.replace('.pdf', '')}_part_${i + 1}.pdf`;
                        downloadFile(pdfBytes, fileName, 'application/pdf');
                    }
                    
                    showMessage(`PDFå·²æ‹†åˆ†ä¸º${numFiles}ä¸ªæ–‡ä»¶ï¼`, 'success');
                } else if (mode === 'range') {
                    // æŒ‰é¡µé¢èŒƒå›´æ‹†åˆ†
                    const ranges = document.getElementById('pageRangesInput').value.split(',');
                    let fileIndex = 1;
                    
                    for (const range of ranges) {
                        const [start, end] = range.trim().split('-').map(n => parseInt(n) - 1);
                        if (start >= 0 && end < totalPages && start <= end) {
                            const newPdf = await PDFLib.PDFDocument.create();
                            const pages = await newPdf.copyPages(pdf, Array.from({length: end - start + 1}, (_, i) => start + i));
                            pages.forEach(page => newPdf.addPage(page));
                            
                            const pdfBytes = await newPdf.save();
                            const fileName = `${file.name.replace('.pdf', '')}_range_${fileIndex}.pdf`;
                            downloadFile(pdfBytes, fileName, 'application/pdf');
                            fileIndex++;
                        }
                    }
                    
                    showMessage(`PDFå·²æŒ‰æŒ‡å®šèŒƒå›´æ‹†åˆ†å®Œæˆï¼`, 'success');
                } else {
                    // æ¯é¡µå•ç‹¬æ‹†åˆ†
                    for (let i = 0; i < totalPages; i++) {
                        const newPdf = await PDFLib.PDFDocument.create();
                        const [page] = await newPdf.copyPages(pdf, [i]);
                        newPdf.addPage(page);
                        
                        const pdfBytes = await newPdf.save();
                        const fileName = `${file.name.replace('.pdf', '')}_page_${i + 1}.pdf`;
                        downloadFile(pdfBytes, fileName, 'application/pdf');
                    }
                    
                    showMessage(`PDFå·²æ‹†åˆ†ä¸º${totalPages}ä¸ªå•é¡µæ–‡ä»¶ï¼`, 'success');
                }
            } catch (error) {
                console.error('æ‹†åˆ†å¤±è´¥:', error);
                showMessage('æ‹†åˆ†å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        async function startCompress() {
            if (!currentFiles.compress || currentFiles.compress.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            const file = currentFiles.compress[0];
            const quality = parseInt(document.getElementById('qualitySlider').value) / 100;
            
            try {
                showMessage('æ­£åœ¨å‹ç¼©PDFæ–‡ä»¶...', 'info');
                
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                
                // åŸºæœ¬çš„PDFä¼˜åŒ–
                const pdfBytes = await pdf.save({
                    useObjectStreams: false,
                    addDefaultPage: false,
                    objectsPerTick: 50
                });
                
                const originalSize = file.size;
                const compressedSize = pdfBytes.length;
                const compressionRatio = ((originalSize - compressedSize) / originalSize * 100).toFixed(1);
                
                const fileName = file.name.replace('.pdf', '_compressed.pdf');
                downloadFile(pdfBytes, fileName, 'application/pdf');
                
                showMessage(`PDFå‹ç¼©å®Œæˆï¼åŸå¤§å°: ${formatFileSize(originalSize)}, å‹ç¼©å: ${formatFileSize(compressedSize)}, å‹ç¼©ç‡: ${compressionRatio}%`, 'success');
            } catch (error) {
                console.error('å‹ç¼©å¤±è´¥:', error);
                showMessage('å‹ç¼©å¤±è´¥: ' + error.message + '\næ³¨æ„: çœŸæ­£çš„PDFå‹ç¼©éœ€è¦ä¸“ä¸šç®—æ³•æ”¯æŒ', 'error');
            }
        }
        
        async function startExtract() {
            if (!currentFiles.extract || currentFiles.extract.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            const file = currentFiles.extract[0];
            const pageRange = document.getElementById('extractPages').value;
            
            if (!pageRange.trim()) {
                showMessage('è¯·è¾“å…¥è¦æå–çš„é¡µé¢èŒƒå›´ï¼Œå¦‚: 1-3,5,7-9', 'error');
                return;
            }
            
            try {
                showMessage('æ­£åœ¨æå–PDFé¡µé¢...', 'info');
                
                const arrayBuffer = await file.arrayBuffer();
                const pdf = await PDFLib.PDFDocument.load(arrayBuffer);
                const totalPages = pdf.getPageCount();
                
                // è§£æé¡µé¢èŒƒå›´
                const pageNumbers = [];
                const ranges = pageRange.split(',');
                
                for (const range of ranges) {
                    const trimmed = range.trim();
                    if (trimmed.includes('-')) {
                        const [start, end] = trimmed.split('-').map(n => parseInt(n));
                        for (let i = start; i <= end; i++) {
                            if (i >= 1 && i <= totalPages) {
                                pageNumbers.push(i - 1); // è½¬ä¸º0åŸºç´¢å¼•
                            }
                        }
                    } else {
                        const pageNum = parseInt(trimmed);
                        if (pageNum >= 1 && pageNum <= totalPages) {
                            pageNumbers.push(pageNum - 1);
                        }
                    }
                }
                
                if (pageNumbers.length === 0) {
                    showMessage('æ²¡æœ‰æ‰¾åˆ°æœ‰æ•ˆçš„é¡µé¢èŒƒå›´', 'error');
                    return;
                }
                
                // åˆ›å»ºæ–°PDFå¹¶å¤åˆ¶æŒ‡å®šé¡µé¢
                const newPdf = await PDFLib.PDFDocument.create();
                const pages = await newPdf.copyPages(pdf, pageNumbers);
                pages.forEach(page => newPdf.addPage(page));
                
                const pdfBytes = await newPdf.save();
                const fileName = file.name.replace('.pdf', '_extracted.pdf');
                downloadFile(pdfBytes, fileName, 'application/pdf');
                
                showMessage(`æˆåŠŸæå–${pageNumbers.length}ä¸ªé¡µé¢ï¼`, 'success');
            } catch (error) {
                console.error('æå–å¤±è´¥:', error);
                showMessage('æå–å¤±è´¥: ' + error.message, 'error');
            }
        }
        
        async function startWatermark() {
            if (!currentFiles.watermark || currentFiles.watermark.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            showMessage('æ°´å°æ·»åŠ åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
        }
        
        async function startProtect() {
            if (!currentFiles.protect || currentFiles.protect.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            showMessage('å¯†ç ä¿æŠ¤åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
        }
        
        async function startUnlock() {
            if (!currentFiles.unlock || currentFiles.unlock.length === 0) {
                showMessage('è¯·å…ˆé€‰æ‹©PDFæ–‡ä»¶', 'error');
                return;
            }
            
            showMessage('è§£é™¤ä¿æŠ¤åŠŸèƒ½æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼', 'info');
        }
        
        // ä¸‹è½½æ–‡ä»¶
        function downloadFile(data, filename, mimeType) {
            const blob = new Blob([data], { type: mimeType });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload();
            setupSliders();
            
            // åˆå§‹åŒ–PDF.js
            if (typeof pdfjsLib !== 'undefined') {
                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
            }
        });
    </script>
</body>
</html>